CREATE DATABASE CupediarumDB;

CREATE TABLE ROLES
(
Id_Rol INT IDENTITY PRIMARY KEY,
Nomb_Rol VARCHAR(50) NOT NULL
);

INSERT INTO ROLES VALUES
('ADMIN'),
('CAJERO'),
('MESERO');

SELECT * FROM ROLES
---------------------------------------------------------------------------------------

CREATE TABLE USUARIOS
(
Id_Usuario INT IDENTITY PRIMARY KEY,
Nomb_Usuario VARCHAR(50) NOT NULL UNIQUE,
Clave VARCHAR(10) NOT NULL,
Estado BIT DEFAULT 1,
Id_Rol INT NOT NULL,
CONSTRAINT FK_USUARIOS_ROLES FOREIGN KEY (Id_Rol)
REFERENCES ROLES(Id_Rol)
);

INSERT INTO USUARIOS (Nomb_Usuario, Clave, Id_Rol) VALUES
('MARCOS','0000',2),
('GABRIEL','1111',3),
('ALEX','1234',1);

SELECT * FROM USUARIOS
---------------------------------------------------------------------------------------

CREATE TABLE AREAS (
Id_Area INT IDENTITY(1,1) PRIMARY KEY,
Nomb_Area VARCHAR(50) NOT NULL,
Estado BIT DEFAULT 1
);

INSERT INTO AREAS(Nomb_Area) VALUES
('SALON'),
('COMEDOR'),
('TERRAZA'),
('BAR');

SELECT * FROM AREAS
---------------------------------------------------------------------------------------

CREATE TABLE MESAS
(
Id_Mesa INT IDENTITY PRIMARY KEY,
Cantidad_Mesa INT NOT NULL,
Id_Area INT NOT NULL,

CONSTRAINT FK_MESAS_AREAS 
FOREIGN KEY (Id_Area) REFERENCES AREAS(Id_Area)
);
-----------------------------------------------------------------------------------------

CREATE TABLE CATEGORIAS 
(
Id_Categoria INT IDENTITY PRIMARY KEY,
Nomb_Categoria VARCHAR(100) NOT NULL,
Id_CategoriaPadre INT NULL,
CONSTRAINT FK_CATEGORIAS_PADRE FOREIGN KEY (Id_CategoriaPadre)
REFERENCES CATEGORIAS(Id_Categoria)
);

INSERT INTO CATEGORIAS (Nomb_Categoria) VALUES
('POSTRES'),
('BEBIDAS'),
('COMIDAS'),
('OTROS');

INSERT INTO CATEGORIAS (Nomb_Categoria, Id_CategoriaPadre) VALUES
('VINOS', 2),
('CERVEZAS', 2),
('SIDRAS', 2),
('WHISKY', 2),
('VODKA', 2),
('GINEBRAS', 2),
('TEQUILAS', 2),
('RON', 2),
('COCTELES', 2),
('COCTELES SIN ALCOHOL', 2),
('JUGOS NATURALES', 2);----BEBIDAS

INSERT INTO CATEGORIAS (Nomb_Categoria, Id_CategoriaPadre) VALUES
('CHICLES', 4),
('CIGARROS', 4),
('DESCORCHE',4);----OTROS

INSERT INTO CATEGORIAS (Nomb_Categoria, Id_CategoriaPadre) VALUES
('POSTRES HORNEADOS', 1),
('POSTRES FRIOS',1),
('CHOCOLATES Y DULCES',1);----POSTRES

INSERT INTO CATEGORIAS (Nomb_Categoria, Id_CategoriaPadre) VALUES
('ENTRADAS',3),
('CARNES',3),
('PESCADOS Y MARISCOS',3),
('HAMBURGUESAS',3),
('PIZZAS',3),
('PARRILADAS',3),
('MOFONGOS',3),
('GUARNICIONES',3);----COMIDA

SELECT 
    C.Nomb_Categoria AS Subcategoria,
    CP.Nomb_Categoria AS CategoriaPadre
FROM Categorias C
LEFT JOIN Categorias CP 
    ON C.Id_CategoriaPadre = CP.Id_Categoria
ORDER BY CP.Nomb_Categoria, C.Nomb_Categoria;
---------------------------------------------------------------------------------------

CREATE TABLE PRODUCTOS (
IdProducto INT IDENTITY(1,1) PRIMARY KEY,
Nomb_Producto VARCHAR(100) NOT NULL,
Precio DECIMAL(10,2) NOT NULL,
Id_Categoria INT NOT NULL,

CONSTRAINT FK_PRODUCTOS_CATEGORIAS
FOREIGN KEY (Id_Categoria) REFERENCES Categorias(Id_Categoria)
);

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MERLOT', 500.00, 5),
('CABERNET', 700.00, 5),
('APHOTIC RED', 1000.00, 5),
('SANTA CAROLINA', 1200.00, 5),
('MARQUEZ DE MURRIETA', 6000.00, 5),
('NUMANTHIA', 4500.00, 5),
('MOSCATO', 800.00, 5),
('CHARDONNAY', 700.00, 5),
('PINOT GRIGIO', 500.00, 5),
('RAMON BILBAO', 1100.00, 5);--VINOS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('PRESIDENTE LIGHT PEQ.',150.00,6),
('PRESIDENTE NORMAL PEQ.',150.00,6),
('PRESIDENTE LIGHT GR.',200.00,6),
('PRESIDENTE NORMAL GR.',200.00,6),
('THE ONE',150.00,6),
('BOHEMIA PEQ.',150.00,6),
('BOHEMIA GR.',200.00,6),
('HEINEKEN',200.00,6),
('PAULANER',250.00,6),
('CORONA',150.00,6);-----CERVEZAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('LA TIERRINA',400.00,7),
('ROSE EVA',350.00,7),
('LACROIX',350.00,7),
('LA REINA',300.00,7),
('PELAYO',150.00,7),
('VIUDA DE ANGELON',1200.00,7),
('MAYADOR',500.00,7);-----SIDRAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('EL CATADOR',2100.00,8),
('JOHNNIE WALKER BLACK LABEL',3000.00,8),
('OLD PAR 12 AÑOS',2500.00,8),
('CHIVAS REGAL 12 AÑOS',2700.00,8),
('BECHANANS 12 AÑOS',3400.00,8),
('GLENFIDDICH 12 AÑOS',3990.00,8),
('BLACK & WHITE', 700.00,8),
('SOMETHING SPECIAL',900.00,8),
('MAKERS MARK',2980.00,8);----WHISKY

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('CIROK',3500.00,9),
('BELVEDERE',2650.00,9),
('GREY GOOSE',2250.00,9),
('STOLICHNAYA',4300.00,9),
('ERISTOFF',900.00,9),
('POLIAKOV',1000.00,9),
('TITOS HANDMADE',1800.00,9);----VODKA

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('LONDON DRY',1500.00,10),
('BEEFEATER',1450.00,10),
('TENQUERAY',2250.00,10),
('MONKEY 47',3800.00,10),
('NORDES',1700.00,10),
('BERMUDEZ LONDON',800.00,10),
('BOMBAY SAPPHIRE',2100.00,10);----GINEBRAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('DON JULIO BLANCO',5000.00,11),
('PATRON SILVER',4850.00,11),
('JARANA REPOSADO',1550.00,11),
('CLASE AZUL',11500.00,11),
('CASAMIJOS',5200.00,11),
('CINCORO',9980.00,11);----TEQUILAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MACORIX BLANCO',650.00,12),
('PUNTA CANA BLANCA',800.00,12),
('BRUGAL',600.00,12),
('BARCELO',750.00,12),
('DOBLE RESERVA',980.00,12),
('LEYENDA',1600.00,12),
('SIBONEY 1920',1270.00,12);----RON

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MOJITO',350.00,13),
('DAIQUIRI',250.00,13),
('NEGRONI',350.00,13),
('MARTINI',300.00,13),
('THOR',450.00,13),
('BLUE LAGOON',450.00,13),
('MARGARITA',350.00,13),
('CAIPIRINHA',450.00,13),
('APEROL SPRITZ',300.00,13),
('SEX ON THE BEACH',350.00,13),
('GIN TONIC',250.00,13),
('VODKA TONIC',250.00,13);----COCTELES

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('CUBA LIBRE',250.00,14),
('PIÑA COLADA',200.00,14),
('TORMENTA NEGRA',300.00,14),
('SHIRLEY TEMPLE',250.00,14),
('VERMUT',400.00,14),
('LIMONADAS',350.00,14),
('HEALTHY SPRITZ',450.00,14);-----COCTELES SIN ALCOHOL

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('LIMON',100.00,15),
('NARANJA',100.00,15),
('SANDIA',100.00,15),
('CEREZA',100.00,15),
('PERA',100.00,15),
('CHINOLA',1100.00,15),
('TAMARINDO',100.00,15),
('MANZANA',100.00,15),
('FRESA',100.00,15);----JUGOS NATURALES

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('BUBBALOO',50.00,16),
('AIRMINTS',60.00,16),
('EXTRA GUM',60.00,16),
('TRIDENT',50.00,16);----CHICLES

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MALBORO',450.00,17),
('CAMEL',360.00,17),
('TEREA',355.00,17),
('CUBA BLEND',150.00,17),
('PORTER',470.00,17);---CIGARROS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('DES. VINO',500.00,18),
('DES. RON',200.00,18),
('DES. VODKA',1000.00,18),
('DES. WISKY',1000.00,18),
('DES. TEQUILA',1500.00,18);----DESCORCHE

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('TRES LECHES',300.00,19),
('BROWNIES',150.00,19),
('CHEESECAKE',400.00,19),
('BIZCOCHO DE CHOCOLATE',300.00,19),
('CUPCAKE',200.00,19),
('GALLETAS DE CHOCOLATE',100.00,19);-----POSTRES ORNEADOS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('FLAN DE CARAMELO',350.00,20),
('TIRAMISU',400.00,20),
('CARLOTAS',200.00,20),
('PUDIN',250.00,20),
('GELATINA',200.00,20),
('NATILLAS',380.00,20);-----POSTRES FRIOS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('CHOCOLATE BLANCO',100.00,21),
('CHOCOLATE RELLENO',150.00,21),
('BOMBONES',50.00,21),
('MALVAVISCOS',100.00,21);-----CHOCOLATES Y DULCES

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('CROQUETAS',100.00,22),
('NACHOS',150.00,22),
('STICKS MOZZARELLA',100.00,22),
('CANASTAS DE CHICHARRON',300.00,22),
('CANASTAS DE POLLO',300.00,22);-----ENTRADAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('PECHUGA A LA PLANCHA',500.00,23),
('PECHUGA A LA CREMA',550.00,23),
('COSTILLAS BBQ/NAT',600.00,23),
('LOMO DE CERDO',550.00,23),
('CHULETA BBQ/NAT',500.00,23),
('LONGANIZA CRIOLLA',525.00,23),
('LONGANIZA PICANTE',525.00,23),
('CARNE SALADA',550.00,23);-----CARNES

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('SALMON',800.00,24),
('PESC. BARBERO',500.00,24),
('MERO',550.00,24),
('CAMARONES',750.00,24),
('PULPO',1000.00,24),
('LANGOSTA',900.00,24),
('CANGREJO',950.00,24),
('ALMEJAS',700.00,24),
('CALAMAR',1300.00,24);------PESCADOS Y MARISCOS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('CHEESEBURGER',300.00,25),
('SMASH BURGER',350.00,25),
('BACON BURGER',450.00,25),
('JUCY LUCY',200.00,25),
('HAMBURGUESA BBQ',300.00,25),
('PATTY MELT',250.00,25);-----HAMBURGUESAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MARGARITA 12/P',1300.00,26),
('CUATRO QUESOS 12/P',1050.00,26),
('PEPPERONI 4/P',500.00,26),
('CATRO ESTACIONES 8/P',900.00,26),
('HAWAIANA 8/P',850.00,26),
('NAPOLITANA 4/P',450.00,26),
('MARINARA 4/P',600.00,26);-----PIZZAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('TABLA MIXTA P2',1050.00,27),
('TABLA MIXTA P4',1600.00,27),
('TABLA MIXTA P6',2150.00,27),
('TABLA MIXTA P8',2650.00,27);------PARRILADAS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('MOGONGO DE CHICHARRON',500.00,28),
('MOFONGO DE POLLO',500.00,28),
('MOFONGO DE CAMARONES',575.00,28),
('MOFONGO MIXTO',700.00,28);-----MOFONGOS

INSERT INTO PRODUCTOS(Nomb_Producto, Precio, Id_Categoria) VALUES
('PAPAS FRITAS',100.00,29),
('TOSTONES',100.00,29),
('YUQUITAS FRITAS',150.00,29),
('CASABE AL AJILLO',100.00,29),
('VEGETALES SALTEADOS',200.00,29);-----GUARNICIONES

SELECT 
    P.Nomb_Producto,
    P.Precio,
    C.Nomb_Categoria AS Subcategoria,
    CP.Nomb_Categoria AS CategoriaPadre
FROM Productos P
INNER JOIN Categorias C ON P.Id_Categoria = C.Id_Categoria 
LEFT JOIN Categorias CP ON C.Id_CategoriaPadre = CP.Id_Categoria;
---------------------------------------------------------------------------------------

CREATE TABLE CUENTAS (
    Id_Cuenta INT IDENTITY(1,1) PRIMARY KEY,
    Nomb_Cuenta VARCHAR(100) NOT NULL,
    FechaApertura DATETIME DEFAULT GETDATE(),
    EstadoCuenta VARCHAR(20) DEFAULT 'Abierta',
    Cantidad_Personas INT NOT NULL,

    Id_Area INT NULL,
    Id_Mesa INT NULL,
    Id_Usuario INT NOT NULL,

    CONSTRAINT FK_Cuentas_Areas
        FOREIGN KEY (Id_Area) REFERENCES AREAS(Id_Area),

    CONSTRAINT FK_Cuentas_Mesas
        FOREIGN KEY (Id_Mesa) REFERENCES MESAS(Id_Mesa),

    CONSTRAINT FK_Cuentas_Usuarios
        FOREIGN KEY (Id_Usuario) REFERENCES USUARIOS(Id_Usuario)
);
 
SELECT Id_Cuenta, Nomb_Cuenta, Id_Area, Id_Mesa, Id_Usuario
FROM CUENTAS;
---------------------------------------------------------------------------------------

CREATE TABLE DETALLE_CUENTA (
    Id_Detalle INT IDENTITY PRIMARY KEY,
    Id_Cuenta INT NOT NULL,
    Id_Producto INT NOT NULL,
    Cantidad INT NOT NULL,
    Precio DECIMAL(10,2) NOT NULL,
    Subtotal AS (Cantidad * Precio) PERSISTED,
    Comentarios VARCHAR(255),
    CONSTRAINT FK__Cuentas
        FOREIGN KEY (Id_Cuenta) REFERENCES Cuentas(Id_Cuenta),
    CONSTRAINT FK_DetalleCuenta_Productos
        FOREIGN KEY (Id_Producto) REFERENCES Productos(IdProducto)
);